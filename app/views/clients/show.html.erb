<section class="mt-4 px-2 md:px-0 md:w-11/12 mx-auto">
  <%= render partial: 'shared/swap_notices' %>
</section>

<section class="mt-8 md:mt-12 px-2 md:px-0 md:w-11/12 mx-auto text-base sm:text-lg md:text-xl">
  <p class="text-xl sm:text-3xl md:text-5xl text-gray-900 font-bold"><%= @client.name %></h1>

  <% if @client.banned? %>
    <p class="mt-2 md:mt-4 text-base sm:text-lg md:text-xl">
      <span class="font-semibold text-red-500"><%= @client.first_name %> has been red-flagged program-wide.</span> They are not eligible to receive SWAP hotel vouchers.
    </p>
  <% end %>

  <% if @client.no_flags? %>
    <p class="mt-2 md:mt-4 text-base sm:text-lg md:text-xl"><span class="font-bold"><%= @client.first_name %></span> is eligible to receive vouchers at any participating SWAP hotel.</p>
  <% end %>

  <div class="mt-4 md:mt-8">
    <% if @editing %>
      <%= render partial: 'client_details_form' , client: @client %>
    <% else %>
      <%= render partial: 'client_details' , client: @client %>
    <% end %>
  </div>

  <div class="mt-8 md:mt-12 text-center text-base md:text-xl">
    <p>
      This isn't the right <span class="font-bold"><%= @client.name %></span>.
      <span class="block md:inline">Take me back to <%= link_to 'client search' , clients_path, class: 'underline text-indigo-600' %>.</span>
    </p>
  </div>

  <div class="my-8 md:my-12">
    <% if @client.has_received_voucher_this_swap_period? %>
      <div class="text-center">
        <%= button_to new_voucher_path(client_id: @client.id), class: button_class(@client.has_received_voucher_this_swap_period?), disabled: true  do %>
          <%= render partial: 'create_voucher_button' %>
        <% end %>
      </div>
      <p class="px-4 md:px-8 my-8 md:my-12 text-base md:text-xl">        
        <span class="font-bold"><%= @client.first_name %></span> has already received a voucher for the SWAP period!
        <%= link_to 'Click here to view it.', @existing_voucher, class: "inline md:block text-base sm:text-lg md:text-xl underline text-indigo-600" %>
      </p>
    <% else %>

      <% if @swap.intake_active? %>

        <% if @client.banned? %>
          <div class="text-center">
            <%= button_tag nil, class: button_class(@client.banned?), disabled: true do %>
              <%= render partial: 'create_voucher_button' %>
            <% end %>
            <p class="px-4 md:px-8 my-8 md:my-12 text-base md:text-xl">
              <span class="font-bold"><%= @client.first_name %></span> is ineligible to receive vouchers at this time.
            </p>
          </div>
        <% else %>

          <% if @client.force_intake? %>

            <div class="text-center">
              <%= button_to new_voucher_path(client_id: @client.id), class: button_class(@client.force_intake?), disabled: true  do %>
                <%= render partial: 'create_voucher_button' %>
              <% end %>
            </div>
            <div class="my-8 md:my-12 max-w-sm md:max-w-xl text-base md:text-xl mx-auto">
              <span class="font-bold"><%= @client.first_name %></span> was previously added as the guest of another voucher recipient. 
              They will have to perform a 
              <%= link_to 'new client intake', new_intake_path(client_id: @client.id), class: 'underline text-indigo-600' %>
              in order to receive a voucher as the primary holder.
            </div>

          <% else %>

            <% if @client.partial_ban? %>
              <div class="my-8 md:my-12 text-base md:text-xl text-center">
                <p><span class="font-bold"><%= @client.first_name %></span> isn't eligible to receive vouchers at the following hotels:</p>
                <ul class="p-1">
                <% @client.flagged_hotels.each do |hotel| %>
                  <li><span class="font-semibold tracking-wide"><%= hotel.name %></span></li>
                <% end %>
                </ul>
              </div>

              <div class="my-8 md:my-16 text-center">
                <%= button_to new_voucher_path(client_id: @client.id), { method: :get, params: { client_id: @client.id }, 
                    class: button_class(!@swap.intake_active?) } do %>
                    <%= render partial: 'create_voucher_button' %>
                    <p class="mb-1 text-xs md:text-base">above sites will <span class="italic">not</span> be available!</p>
                <% end %>
              </div>
            <% end %>

            <% if @client.no_flags? %>
              <div class="my-8 md:my-16 text-center">
                <%= button_to new_voucher_path(client_id: @client.id), 
                    { method: :get, params: { client_id: @client.id }, 
                    class: button_class(!@swap.intake_active?) } do %>
                    <%= render partial: 'create_voucher_button' %>
                <% end %>
              </div>
            <% end %>
          <% end %>
        <% end %>
      <% else %>
        <div class="mt-y md:my-16 text-center">
          <%= button_tag nil, class: button_class(!@swap.intake_active?), disabled: true do %>
            <%= render partial: 'create_voucher_button' %>
          <% end %>
          <p class="px-4 md:px-8 my-6 md:my-8 text-base md:text-xl">
            Vouchers can only be issued during the SWAP intake period.
          </p>
        </div>
      <% end %>
    <% end %>
  </div>
</section>